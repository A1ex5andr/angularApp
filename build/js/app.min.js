(function() {

	// TODO: would be good to iterate over each 'angular.module' in /modules and add to dependencies
	var app = angular.module('store', [
		'ngRoute',
		'catalog',
		'storeService',
		'store-gallery',
		'store-panel',
		'contact',
		'scopeTest',
		'cart'
	]);

	app.config(['$routeProvider', function ($routeProvider) {
		$routeProvider
			// Home
			.when("/", {templateUrl: "layout/home.html", controller: "PageCtrl"})

			// main page modules
			.when("/catalog", {templateUrl: "layout/catalog.html", controller: "PageCtrl"})
			.when("/contact", {templateUrl: "layout/contact.html", controller: "ContactCtrl"})
			.when("/cart", {templateUrl: "layout/cart.html", controller: "PageCtrl"})
			.when("/test", {templateUrl: "layout/test.html", controller: "PageCtrl"})

			// else 404
			.otherwise("/404", {templateUrl: "layout/404.html", controller: "PageCtrl"})
	}]);

	app.controller('PageCtrl', function (/* $scope, $location, $http */) {
		console.log("Page Controller reporting on duty.");
	});

}());
var app  = angular.module('storeService', []);

    app.service('productService', function() {

        var productList = [];

        var addProduct = function(id) {
            productList.push(id);
        };

        // ToDO create a callback func
        var getProducts = function(){
            return productList;
        };

        return {
            addProduct: addProduct,
            getProducts: getProducts
        };

    });
(function () {

    var app = angular.module('cart', []);

    app.controller('CartCtrl', function ($scope, productService, $http) {

        $scope.products = productService.getProducts();
        this.inCart = $scope.products;
        this.qty = 1;

        console.log(this.inCart);

        var store = this;
        store.products = [];
        $http.get('products.json').
            success(function (data) {
                store.products = data;
            });


        });
}());
var app = angular.module('catalog', []);

    app.controller('CatalogController', ['$http', function ($http) {
        var store = this;
        store.products = [];


        //todo as a service
        $http.get('products.json').
            success(function (data) {
                store.products = data;
            });


    }]);
(function () {
   angular.module('contact', [])
       .controller('ContactCtrl', function () {
           // Activates Tooltips for Social Links
           $('.tooltip-social').tooltip({
               selector: "a[data-toggle=tooltip]"
           });
       });
}());
angular.module('scopeTest', [])

    .controller('FirstCtrl', function () {

    }).controller('SecondCtrl', function () {

});


(function(){

    var app = angular.module('store-panel', []);

    app.controller('ProductController', function($scope, productService) {
        this.sendToCart = function(product){
            var productNew = product.id;
            var alreadyInCart = productService.getProducts();
            var existInCart = jQuery.inArray(productNew, alreadyInCart);

            function checkExist() {
                if (existInCart === -1 ){
                    productService.addProduct(productNew);
                }
            }
            checkExist();
            console.log(alreadyInCart);

        };
    });

    app.directive('productPanel', function () {
        return{
            restrict: 'A',
            templateUrl: 'layout/product-panel.html',
            controller: function () {
                this.tab = 1;
                this.selectTab = function(setTab) {
                    this.tab = setTab;
                };
                this.isSet = function (checkTab) {
                    return this.tab === checkTab;
                };
            },
            controllerAs: 'panel'
        };
    });

    app.directive('productDescription', function(){
        return {
            restrict: 'E',
            templateUrl: 'layout/product-description.html'
        };
    });

    app.directive('productSpecs', function () {
        return{
            restrict: 'E',
            templateUrl: 'layout/product-specs.html'
        };
    });

    app.directive('productReview', function () {
        return{
            restrict: 'E',
            templateUrl: 'layout/product-review.html',
            controller: function () {
                this.review = {};
                this.addReview = function(product){
                    this.review.createdOn = Date.now();
                    product.reviews.push(this.review);
                    this.review = {};
                };
            },
            controllerAs: 'reviewCtrl'

        };
    });

}());
(function () {
    var app = angular.module('store-gallery', []);
    app.directive('productGallery', function () {
        return{
            restrict: 'A',
            templateUrl: 'layout/product-gallery.html',
            controller: function () {
                this.pic = 1;
                this.setPic = function(pic){
                    if (pic !== null) {
                        this.pic = pic;
                    } else {
                        this.pic = 0;
                    }
                };
            },
            controllerAs: 'gallery'
        };
    });
}());